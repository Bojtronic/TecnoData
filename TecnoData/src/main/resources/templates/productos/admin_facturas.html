<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Lista de Facturas</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
</head>
<body>
    <!-- Header -->
    <div th:replace="fragments.html :: header"></div>

    <div class="container mt-5">
        <h1 class="mb-4">Lista de Facturas</h1>

        <!-- Tabla de facturas -->
        <table class="table table-bordered table-hover">
            <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>Fecha</th>
                    <th>Total</th>
                    <th>Detalles</th>
                </tr>
            </thead>
            <tbody>
                <!-- Iterar sobre la lista de facturas -->
                <tr th:each="factura : ${facturas}">
                    <td th:text="${factura.id}"></td>
                    <td th:text="${factura.fecha}"></td>
                    <td th:text="${factura.total}"></td>
                    <td>
                        <!-- BotÃ³n para mostrar/ocultar detalles -->
                        <button class="btn btn-primary btn-sm" type="button" data-bs-toggle="collapse" 
                                th:attr="data-bs-target='#detalles-factura-' + ${factura.id}">
                            Ver Detalles
                        </button>
                    </td>
                </tr>
                <!-- Fila de detalles (colapsable) -->
                <tr class="collapse" th:id="'detalles-factura-' + ${factura.id}">
                    <td colspan="4">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Producto</th>
                                    <th>Cantidad</th>
                                    <th>Subtotal</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="detalle : ${factura.detalles}">
                                    <td th:text="${detalle.producto.nombre}"></td>
                                    <td th:text="${detalle.cantidad}"></td>
                                    <td th:text="${detalle.subtotal}"></td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Footer -->
    <div th:replace="fragments.html :: footer"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
